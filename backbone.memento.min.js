/*!
Backbone.Memento v0.4.2

Copyright (C)2011 Derick Bailey, Muted Solutions, LLC
Distributed Under MIT License

Documentation and Full License Available at:
http://github.com/derickbailey/backbone.memento
*/
!function(e,n){"function"==typeof define&&define.amd?define(["underscore","backbone"],n):"object"==typeof module&&module.exports?module.exports=n(require("underscore"),require("backbone")):e.Backbone.Memento=n(e._,e.Backbone)}(this,function(e,n){"use strict";var r=function(n,r){this.version="0.4.2",r=e.extend({ignore:[]},r);var t=new o(n,r),u=new i(n,r),s=function(e,n){e&&t.deserialize(e,n)};this.store=function(){var e=t.serialize();u.push(e)},this.restore=function(e){var n=u.pop();s(n,e)},this.restart=function(e){var n=u.rewind();s(n,e)}},t=function(e){e instanceof n.Model?(this.removeAttr=function(n){e.unset(n)},this.restore=function(n){e.set(n)}):(this.removeAttr=function(n){e.remove(n)},this.restore=function(n){e.reset(n)})},o=function(n,r){function o(n,r){if(n=e.clone(n),r.hasOwnProperty("ignore")&&r.ignore.length>0)for(var t in r.ignore){var o=r.ignore[t];delete n[o]}return n}function i(e,n){var r=[];if(!e||!n)return r;for(var t in n)n.hasOwnProperty(t)&&(e.hasOwnProperty(t)||r.push(t));return r}function u(e,n){for(var r in n){var t=n[r];f.removeAttr(t)}}function s(e,r){var t=o(e,r),s=n.toJSON();s=o(s,r);var c=i(t,s);u(n,c),f.restore(t)}var f=new t(n);this.serialize=function(){var e=n.toJSON();return e=o(e,r)},this.deserialize=function(n,t){t=e.extend({},r,t),s(n,t)}},i=function(){function e(){n=[]}var n;this.push=function(e){n.push(e)},this.pop=function(){var e=n.pop();return e},this.rewind=function(){var r=n[0];return e(),r},e()};return n.Memento=r,r});