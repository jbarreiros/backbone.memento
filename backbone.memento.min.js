/*!
Backbone.Memento v0.4.2

Copyright (C)2011 Derick Bailey, Muted Solutions, LLC
Distributed Under MIT License

Documentation and Full License Available at:
http://github.com/derickbailey/backbone.memento
*/
!function(e,n){"function"==typeof define&&define.amd?define(["backbone","underscore"],n):"object"==typeof exports?module.exports=n(require("backbone"),require("underscore")):n(e.Backbone,e._)}(this,function(e,n){"use strict";var r=function(e,r){this.version="0.4.2",r=n.extend({ignore:[]},r);var t=new i(e,r),u=new o(e,r),s=function(e,n){e&&t.deserialize(e,n)};this.store=function(){var e=t.serialize();u.push(e)},this.restore=function(e){var n=u.pop();s(n,e)},this.restart=function(e){var n=u.rewind();s(n,e)}},t=function(n){n instanceof e.Model?(this.removeAttr=function(e){n.unset(e)},this.restore=function(e){n.set(e)}):(this.removeAttr=function(e){n.remove(e)},this.restore=function(e){n.reset(e)})},i=function(e,r){function i(e,r){if(e=n.clone(e),r.hasOwnProperty("ignore")&&r.ignore.length>0)for(var t in r.ignore){var i=r.ignore[t];delete e[i]}return e}function o(e,n){var r=[];if(!e||!n)return r;for(var t in n)n.hasOwnProperty(t)&&(e.hasOwnProperty(t)||r.push(t));return r}function u(e,n){for(var r in n){var t=n[r];f.removeAttr(t)}}function s(n,r){var t=i(n,r),s=e.toJSON();s=i(s,r);var c=o(t,s);u(e,c),f.restore(t)}var f=new t(e);this.serialize=function(){var n=e.toJSON();return n=i(n,r)},this.deserialize=function(e,t){t=n.extend({},r,t),s(e,t)}},o=function(){function e(){n=[]}var n;this.push=function(e){n.push(e)},this.pop=function(){var e=n.pop();return e},this.rewind=function(){var r=n[0];return e(),r},e()};return e.Memento=r,r});